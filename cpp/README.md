## libfileseq

#### C++ port of gofileseq

[Latest API Docs](http://justinfx.com/gofileseq/cpp)

### Features

* Frame range parsing: `1-100`, `1-100x5`, `1-100:3`, comma-separated ranges
* Padding formats: `#`, `@`, `%04d`, `$F4`, `<UDIM>`
* Multi-part file extensions: `.tar.gz`, `.bgeo.sc`
* Hidden files and special characters in filenames
* Negative frame numbers
* Whitespace preservation in file paths
* Cross-platform path support (Unix and Windows)

### Build Requirements

* [CMake](https://cmake.org/) 3.15+
* C++11 compatible compiler (GCC 4.8+, Clang 3.3+, MSVC 2013+)
* Java 8+ (optional, only needed to regenerate the ANTLR parser from grammar)

### Runtime Dependencies

None - ANTLR4 C++ runtime is vendored and statically linked.

### Building with CMake

```shell
$ cd <path/to/gofileseq>/cpp
$ mkdir build && cd build
$ cmake ..
$ make
$ ./fileseq_tests
```

#### Build Options

The project includes several build targets:

* `make` - Build the library and tests
* `make fileseq` - Build only the library
* `make fileseq_tests` - Build the test executable
* `make test` or `ctest` - Run tests via CTest

### Installation

```shell
$ cd build
$ cmake -DCMAKE_INSTALL_PREFIX=/path/to/install ..
$ make install
```

This installs:
* Headers to `<prefix>/include/fileseq/`
* Static library (`libfileseq.a`) to `<prefix>/lib/`
* Shared library (`libfileseq.so`/`.dylib`) to `<prefix>/lib/`

The static library is self-contained with ANTLR4 runtime merged in, requiring no external dependencies.

### Development

The file sequence parser is built using an [ANTLR4](https://www.antlr.org/) grammar defined in `grammar/fileseq.g4`.

When the grammar file is modified, the C++ parser must be regenerated and committed:

```bash
# Regenerate C++ parser from grammar (requires Java)
cd grammar && make generate-cpp

# Or regenerate all language parsers
cd grammar && make generate-all
```

The ANTLR4 C++ runtime (v4.9.3) is vendored in `ext/antlr4/` and statically linked. The generator uses ANTLR 4.9.3 JAR for code generation, compatible with GCC 4.8+ and C++11. No external ANTLR installation is required to build the project.

#### Running Tests

```shell
$ cd build
$ ./fileseq_tests

# Or run specific tests
$ ./fileseq_tests --gtest_filter=TestNewFileSequences.*
```

#### Project Structure

```
cpp/
├── CMakeLists.txt           # CMake build configuration
├── ext/
│   ├── antlr4/             # Vendored ANTLR4 C++ runtime (static)
│   └── gtest/              # Vendored Google Test framework
├── private/
│   ├── parser/             # ANTLR parser (generated + hand-written)
│   │   ├── fileseq*.cpp    # Generated by ANTLR
│   │   ├── parse.cpp       # Hand-written visitor implementation
│   │   └── parse_postprocess.cpp  # Special case handling
│   └── ...                 # Internal implementation files
├── test/                   # Unit tests
├── fileseq.h               # Public API header
└── *.cpp                   # Implementation files
```

